errorSearchSelectWithGroupRepairEligible:
BEFORE : select distinct date, info.err_roe_id, info.actn_type actionType, erd.firm_roe_id, info.err_list as err_cd, info.err_type, L2.err_ds as err_rsn, info.rprd_smry, info.cat_rprtr_org_id, info.cat_rprtr_imid, info.cat_sbmtr_id,  erd.sym, erd.event_ts,  erd.seq_nb,  erd.qty,  erd.sndr_imid, erd.odr_id, erd.odr_key_dt, erd.trd_id , erd.trd_key_dt , erd.flmnt_id , erd.fill_key_dt , erd.quote_id , erd.quote_key_dt , erd.optn_id , erd.msg_type eventType, erd.rcvr_imid , erd.dstnt, erd.rtd_odr_id , erd.sssn , erd.tape_trd_id , erd.prnt_odr_id , erd.prnt_odr_key_dt , erd.prior_odr_id , erd.prior_odr_key_dt , erd.prior_flmnt_id , erd.prior_fill_key_dt , erd.prior_quote_id , erd.prior_quote_key_dt, info.rpr_ts , info.rpr_user_id , info.rpr_type_cd , info.crctn_due_ts, info.file_nm, info.grp_rpr_fl from (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.actn_type, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, eri.rpr_ts rpr_ts, eri.rpr_user_id rpr_user_id, eri.rpr_type_cd rpr_type_cd, eri.crctn_due_ts crctn_due_ts, eri.file_nm file_nm, case when position(',' in trim(eri.err_list)) > 0 then null else eri.err_list end as err_list, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' when eri.rprd_st = 'U' and L1.err_cd is not null and position(',' in eri.err_list) = 0 and pnd.err_roe_id is null then 'Y' else 'N'  end  as grp_rpr_fl,  eri.err_type err_type FROM catco_owner.err_rec_info eri  JOIN catco_owner.err_rec_cd erc ON (eri.err_roe_id = erc.err_roe_id AND %s) LEFT JOIN catdd_owner.err_cd_lk L1 ON (L1.err_cd = erc.err_cd and L1.grp_rpr_elgbl = 'Y') LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd    ON ( eri.err_roe_id = pnd.err_roe_id ) WHERE %s )info JOIN catco_owner.err_rec_dtl erd ON (info.err_roe_id = erd.err_roe_id) LEFT JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd::text = info.err_list) %s %s
AFTER  : select distinct date, info.err_roe_id, info.actn_type actionType, erd.firm_roe_id, info.err_list as err_cd, info.err_type, L2.err_ds as err_rsn, info.rprd_smry, info.cat_rprtr_org_id, info.cat_rprtr_imid, info.cat_sbmtr_id,  erd.sym, erd.event_ts,  erd.seq_nb,  erd.qty,  erd.sndr_imid, erd.odr_id, erd.odr_key_dt, erd.trd_id , erd.trd_key_dt , erd.flmnt_id , erd.fill_key_dt , erd.quote_id , erd.quote_key_dt , erd.optn_id , erd.msg_type eventType, erd.rcvr_imid , erd.dstnt, erd.rtd_odr_id , erd.sssn , erd.tape_trd_id , erd.prnt_odr_id , erd.prnt_odr_key_dt , erd.prior_odr_id , erd.prior_odr_key_dt , erd.prior_flmnt_id , erd.prior_fill_key_dt , erd.prior_quote_id , erd.prior_quote_key_dt, info.rpr_ts , info.rpr_user_id , info.rpr_type_cd , info.crctn_due_ts, info.file_nm, info.grp_rpr_fl from (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.actn_type, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, eri.rpr_ts rpr_ts, eri.rpr_user_id rpr_user_id, eri.rpr_type_cd rpr_type_cd, eri.crctn_due_ts crctn_due_ts, eri.file_nm file_nm, case when position(',' in trim(eri.err_list)) > 0 then null else eri.err_list end as err_list, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' WHEN eri.rprd_st = 'U'  AND pnd.err_roe_id IS NULL AND eri.grp_rpr_elgbl = 'Y' THEN 'Y' else 'N'  end  as grp_rpr_fl,  eri.err_type err_type FROM catco_owner.err_rec_info eri LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd ON ( eri.err_roe_id = pnd.err_roe_id ) WHERE %s )info JOIN catco_owner.err_rec_dtl erd ON (info.err_roe_id = erd.err_roe_id) LEFT JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd::text = info.err_list) %s %s


errorSearchTotalCountSelectWithGroupRepairEligible:
BEFORE : select count(distinct info.err_roe_id) totalRowCount from (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, eri.rpr_ts rpr_ts, eri.rpr_user_id rpr_user_id, eri.rpr_type_cd rpr_type_cd, eri.crctn_due_ts crctn_due_ts, eri.file_nm file_nm, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' when eri.rprd_st = 'U' and L1.err_cd is not null and position(',' in eri.err_list) = 0 and pnd.err_roe_id is null then 'Y' else 'N'  end  as grp_rpr_fl,  eri.err_type err_type, eri.err_list err_list FROM catco_owner.err_rec_info eri  JOIN catco_owner.err_rec_cd erc ON (eri.err_roe_id = erc.err_roe_id AND %s) LEFT JOIN catdd_owner.err_cd_lk L1 ON (L1.err_cd = erc.err_cd and L1.grp_rpr_elgbl = 'Y') LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd    ON ( eri.err_roe_id = pnd.err_roe_id ) WHERE %s )info JOIN catco_owner.err_rec_dtl erd ON (info.err_roe_id = erd.err_roe_id) LEFT JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd::text = info.err_list) %s
AFTER  : select count(distinct info.err_roe_id) totalRowCount from (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, eri.rpr_ts rpr_ts, eri.rpr_user_id rpr_user_id, eri.rpr_type_cd rpr_type_cd, eri.crctn_due_ts crctn_due_ts, eri.file_nm file_nm, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' WHEN eri.rprd_st = 'U'  AND pnd.err_roe_id IS NULL AND eri.grp_rpr_elgbl = 'Y' THEN 'Y' else 'N'  end  as grp_rpr_fl,  eri.err_type err_type, eri.err_list err_list FROM catco_owner.err_rec_info eri LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd ON ( eri.err_roe_id = pnd.err_roe_id ) WHERE %s )info JOIN catco_owner.err_rec_dtl erd ON (info.err_roe_id = erd.err_roe_id) LEFT JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd::text = info.err_list) %s


errorSummarySelect:
BEFORE : SELECT date, abc.cat_rprtr_imid catImid, abc.cat_sbmtr_id catSubmitterId, abc.rprd_smry repairedStatus, abc.grp_rpr_fl groupRepairFlag, abc.err_type errorType, abc.err_cd errorCode, l2.err_ds errorReason, abc.rpr_type_cd repairedType, COUNT(*) errorCount FROM (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' when eri.rprd_st = 'U' and L1.err_cd is not null and coalesce(Q1.cnt1,0) = 1 and pnd.err_roe_id is null then 'Y' else 'N'  end  as grp_rpr_fl, eri.err_type err_type, eri.rpr_type_cd rpr_type_cd, erc.err_cd err_cd FROM catco_owner.err_rec_info eri JOIN catco_owner.err_rec_cd erc ON (eri.err_roe_id = erc.err_roe_id AND %s ) LEFT JOIN (SELECT eri.err_roe_id roeid, count(1) cnt1 FROM catco_owner.err_rec_info eri JOIN catco_owner.err_rec_cd erc ON (eri.err_roe_id = erc.err_roe_id AND %s and eri.rprd_st = 'U') group by eri.err_roe_id) Q1 ON (Q1.roeid = eri.err_roe_id ) LEFT JOIN catdd_owner.err_cd_lk L1 ON (L1.err_cd = erc.err_cd and L1.grp_rpr_elgbl = 'Y') LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd ON ( eri.err_roe_id = pnd.err_roe_id )) ABC JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd = ABC.err_cd) %s GROUP BY date, abc.cat_rprtr_imid, abc.cat_sbmtr_id, abc.rprd_smry, abc.grp_rpr_fl, abc.err_type, abc.err_cd, L2.err_ds, abc.rpr_type_cd %s %s
AFTER  : SELECT date, abc.cat_rprtr_imid catImid, abc.cat_sbmtr_id catSubmitterId, abc.rprd_smry repairedStatus, abc.grp_rpr_fl groupRepairFlag, abc.err_type errorType, abc.err_cd errorCode, l2.err_ds errorReason, abc.rpr_type_cd repairedType, COUNT(*) errorCount FROM (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' WHEN eri.rprd_st = 'U'  AND pnd.err_roe_id IS NULL AND eri.grp_rpr_elgbl = 'Y' THEN 'Y' else 'N'  end  as grp_rpr_fl, eri.err_type err_type, eri.rpr_type_cd rpr_type_cd, trim (unnest(regexp_split_to_array(eri.err_list, ',')))::int err_cd FROM catco_owner.err_rec_info eri LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd ON ( eri.err_roe_id = pnd.err_roe_id ) %s) ABC JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd = ABC.err_cd) %s GROUP BY date, abc.cat_rprtr_imid, abc.cat_sbmtr_id, abc.rprd_smry, abc.grp_rpr_fl, abc.err_type, abc.err_cd, L2.err_ds, abc.rpr_type_cd %s %s



errorSummaryLastRowSelect:
BEFORE : SELECT COUNT(*) lastRow FROM (SELECT distinct date, abc.cat_rprtr_imid catImid, abc.cat_sbmtr_id catSubmitterId, abc.rprd_smry repairedStatus, abc.grp_rpr_fl groupRepairFlag, abc.err_type errorType, abc.err_cd errorCode, l2.err_ds errorReason, abc.rpr_type_cd repairedType FROM (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' when eri.rprd_st = 'U' and L1.err_cd is not null and coalesce(Q1.cnt1,0) = 1 and pnd.err_roe_id is null then 'Y' else 'N'  end  as grp_rpr_fl, eri.err_type err_type, eri.rpr_type_cd rpr_type_cd, erc.err_cd err_cd FROM catco_owner.err_rec_info eri JOIN catco_owner.err_rec_cd erc ON (eri.err_roe_id = erc.err_roe_id AND %s ) LEFT JOIN (SELECT eri.err_roe_id roeid, count(1) cnt1 FROM catco_owner.err_rec_info eri JOIN catco_owner.err_rec_cd erc ON (eri.err_roe_id = erc.err_roe_id AND %s and eri.rprd_st = 'U') group by eri.err_roe_id) Q1 ON (Q1.roeid = eri.err_roe_id ) LEFT JOIN catdd_owner.err_cd_lk L1 ON (L1.err_cd = erc.err_cd and L1.grp_rpr_elgbl = 'Y') LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd ON ( eri.err_roe_id = pnd.err_roe_id )) ABC JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd = ABC.err_cd) %s ) totalRecordCountQuery
AFTER  : SELECT COUNT(*) lastRow FROM (SELECT distinct date, abc.cat_rprtr_imid catImid, abc.cat_sbmtr_id catSubmitterId, abc.rprd_smry repairedStatus, abc.grp_rpr_fl groupRepairFlag, abc.err_type errorType, abc.err_cd errorCode, l2.err_ds errorReason, abc.rpr_type_cd repairedType FROM (SELECT %s, eri.err_roe_id err_roe_id, eri.cat_rprtr_org_id cat_rprtr_org_id, eri.cat_rprtr_imid cat_rprtr_imid, eri.cat_sbmtr_id cat_sbmtr_id, eri.prdct_type prdct_type, case when eri.rprd_st = 'R' then 'R' when eri.rprd_st = 'U' and pnd.err_roe_id is null then 'U' else pnd.rprd_st end as rprd_smry, case when eri.rprd_st = 'R' then 'N' WHEN eri.rprd_st = 'U' and pnd.err_roe_id is null AND eri.grp_rpr_elgbl = 'Y' then 'Y' else 'N'  end  as grp_rpr_fl, eri.err_type err_type, eri.rpr_type_cd rpr_type_cd, trim (unnest(regexp_split_to_array(eri.err_list, ',')))::int err_cd FROM catco_owner.err_rec_info eri LEFT JOIN (select err_roe_id, max(rprd_st) as rprd_st from catdd_owner.pndng_rec where err_roe_id is not null group by err_roe_id) pnd ON ( eri.err_roe_id = pnd.err_roe_id ) %s) ABC JOIN catdd_owner.err_cd_lk L2 ON (L2.err_cd = ABC.err_cd) %s ) totalRecordCountQuery



